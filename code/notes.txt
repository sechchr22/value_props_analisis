# historial de 1 mes de value props que fueron mostradas a cada usuario
print = {"day":"2020-11-01","event_data":{"position":0,"value_prop":"cellphone_recharge"},"user_id":98702}

# historial de 1 mes de value props que fueron clickeadas por un usuario
tap = {"day":"2020-11-01","event_data":{"position":0,"value_prop":"cellphone_recharge"},"user_id":98702}

# pays
# historial de 1 mes de pagos realizados por los usuarios
pay_date,total,user_id,value_prop
2020-11-01,7.04,35994,link_cobro
2020-11-01,37.36,79066,cellphone_recharge

# Retornar un dataset listo para que el modelo lo consuma
# este debe tener:
# Prints de la ultima semana
  # Cada print debe tener:
    # campo que indique si el usuario hizo click o no (o esto es si el usuario dio click a ese print? no hay identificador por print y tap para hacerlo o maybe es el campo position?) --> CASE IF SOURCE TAPS THEN 1 AS CLICK COLUMN 
    # cantidad de veces que el usuario vio cada value prop en las 3 semanas previas al print --> COUNT() GROUP BY USER WHERE DAY < 3 weeks de la ultima semana THE GROUP BY IS BY VALUE PROP, I HAVE TO THINK IN A WAY TO GET OUT THE VALUE PROP FROM THE EVENT DATA JSON FIELD AND MAKE IT A COLUMN SO I CAN CONCATENATE BY VALUE PROP
    # cantidad de veces que el usuario clickeo cada value prop en las 3 semanas previas al print --> COUNT() GROUP BY USER WHERE DAY < 3 weeks de la ultima semana
    # cantidad de pagos que el usuario realizo por cada value prop en las 3 semanas previas al print --> COUNT() GROUP BY USER WHERE DAY < 3 weeks de la ultima semana
    # importes acumulados (suma total de los gastos) que el usuario gasto por cada value prop en las 3 semanas previas al print --> SUM() GROUP BY USER WHERE DAY < 3 weeks de la ultima semana